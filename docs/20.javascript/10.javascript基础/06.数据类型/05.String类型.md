---
title: String类型
date: 2021-01-06 10:07:01
permalink: /pages/sefewesasweew
author: 
  name: jeffery
categories: 
  - javascript
  - 数据类型
tags: 
  - javascript
  - 数据类型
---

# String 类型

## 定义

字符串 `String` 类型是由引号括起来的一组由 `16` 位`Unicode` 字符组成的字符序列

### Unicode编码

`javascript` 采用`UTF-16`编码的 `Unicode` 字符集，`javascript` 字符串是由一组无符号的16位值组成的序列。最常用的 `Unicode` 字符都是通过16位的内码表示，并代表字符串中的单个字符

所有字符都可以写成 `'\uxxxx'` 的形式，其中 `xxxx` 代表该字符的 `Unicode` 编码。比如，`\u00A9` 代表版权符号

```js
var s = '\u00A9';
s // "©"
```

### 特点

`javascript` 中的字符串是不可变的。一旦字符串被创建，就永远无法改变它。要改变某个变量保存的字符串，首先要销毁原来的字符串，然后再用另一个包含新值的字符串填充该变量

可以通过 `+` 运算符连接其他字符串来创建一个新字符串
```js
var lang = "java";
lang = lang + "script"; //'javascript'
```

## 转义字符 

在 `javascript` 字符串，反斜线 `\` 有着特殊的用途，反斜线符号后加一个字符，就不表示它们的字面含义，用来表示一些特殊字符，称为转义字符

```
\0 空字节
\n 换行
\t 制表
\b 空格
\r 回车
\f 缩进
\\ 斜杠
\' 单引号
\" 双引号
\xnn 以十六进制nn表示一个字符(n为0-f)，如\x41表示'A'
\unnnn 以十六进制nnnn表示一个Unicode字符(n为0-f)，如\u03a3表示希腊字符ε
```

## 转字符串

把一个值转换为字符串有两种方式，`toString()` 和 `String()`

**toString()**

用几乎每个值都有的 `toString()` 方法，这个方法返回相应值的字符串表现

注意：`undefined`和 `null` 没有该方法

```js
undefined.toString();//错误
null.toString();//错误
true.toString();//'true'
false.toString();//'false'
'abc'.toString();//'abc'
1.23.toString();//'1.23'
({}).toString();//[object Object]
[1,2,3,4].toString();//'1,2,3,4'
(new Date()).toString();//"Sun Jun 05 2016 10:04:53 GMT+0800 (中国标准时间)"
/ab/i.toString();//'/ab/i'
```

**String()**

在不知道要转换的值是不是 `undefined` 或 `null` 时，可以使用转型函数 `String()`

转型函数 `String()`遵循下列规则：

【1】如果值是 `null`，则返回 `'null'`；如果值是 `undefined`，则返回 `'undefined'`

【2】如果值不是 `null` 或 `undefined`，则调用 `toString()` 方法并返回原始类型值

【3】若使用 `toString()`方法返回的是对象，则再调用 `valueOf()` 方法返回原始类型值，若使用`valueOf()` 方法返回的是对象，会报错

```js
// "3"
String({toString: function () {
    return 3;
  }
})
// "[object Object]"
String({valueOf: function () {
    return 2;
  }
})
// "3"
String({
  valueOf: function () {
    return 2;
  },
  toString: function () {
    return 3;
  }
})
```

## String 属性

字符串 `String` 类型的每个实例都有一个 `length` 属性，表示字符串中的字符个数。由于字符串是不可变的，所以字符串的长度也不可变

字符串的 `length` 属性不会在 `for/in` 循环中枚举，也不能通过 `delete` 操作符删除

```js
var str = "test";
console.log(str.length);//4
str.length = 6;
console.log(str,str.length);//"test",4
```

## String 实例方法

字符串 `String` 对象有多达20多个实例方法

- `toString()`、`toLocaleString()`、`valueOf()`从 `Object` 对象继承的3种对象通用方法
- `chartAt()`、中括号 `[]`、`charCodeAt()`和 `fromCharCode()` 4种访问字符方法
- `concat()`和加号 `+` 2种字符串拼接方法
- `slice()`、`substr()`和`substring()`3种创建子字符串方法
- `toLowerCase()`、`toLocaleLowerCase()`、`toUpperCase()`、`toLocaleUpperCase()` 4种大小写转换方法
- `indexOf()`和 `lastIndexOf()` 2种查找字符串位置的方法
- `match()`、`search()`、`replace()`、`split()` 4种正则匹配方法
- 去除首尾空格的 `trim()` 和字符串比较的 `localeCompare()` 方法

接下来总结几个常用到但不容易区分和使用的几个方法

### 创建子字符串

**slice()**

`slice(start,end)` 方法需要两个参数 `start` 和 `end`，返回这个字符串中从 `start`位置的字符到(但不包含)`end`位置的字符的一个子字符串；
- `end`为 `undefined` 或不存在，则返回从 `start` 位置到字符串结尾的所有字符

- `start` 是负数，则 `start = max(length + start,0)`

- `end` 是负数，则 `end = max(length + end,0)`

- `start`和`end`无法交换位置

```js
var stringValue = 'hello world';
console.log(stringValue.slice());//'hello world'
console.log(stringValue.slice(0, 2));//'he'
console.log(stringValue.slice(0, -2));//'hello wor'
console.log(stringValue.slice(2));//'llo world'
console.log(stringValue.slice(-2));//'ld'
console.log(stringValue.slice(2,undefined));//'llo world'
console.log(stringValue.slice(2,-5));//'llo '
console.log(stringValue.slice(2,-20));//''
console.log(stringValue.slice(20));//''
console.log(stringValue.slice(-2,2));//''
console.log(stringValue.slice(-2,-20));//''            
console.log(stringValue.slice(-2,20));//'ld'
console.log(stringValue.slice(-20,2));//'he'
console.log(stringValue.slice(-20,-2));//'hello wor'
```

**substring()**

`substring(start,end)`方法需要两个参数 `start` 和 `end`，返回这个字符串中从 `start` 位置的字符到(但不包含) `end` 位置的字符的一个子字符串；

-  `end` 为 `undefined` 或不存在，则返回从 `start` 位置到字符串结尾的所有字符

- 任一参数是 `NaN` 或 `负数`，则被 `0` 取代

- 任一参数大于字符串长度，则被字符串长度取代

-  `start`大于 `end`，则交换它们的值

```js
var stringValue = 'hello world';
console.log(stringValue.substring());//'hello world'
console.log(stringValue.substring(2));//'llo world'
console.log(stringValue.substring(2,undefined));//'llo world'
console.log(stringValue.substring(20));//''
console.log(stringValue.substring(-2,2));//'he'
console.log(stringValue.substring(NaN,2));//'he'
console.log(stringValue.substring(-2,20));//'hello world'
console.log(stringValue.substring(3,2));//'l'
console.log(stringValue.substring(3,NaN));//'hel'
console.log(stringValue.substring(-20,2));//'he'
console.log(stringValue.substring(-20,-2));//'' 
```

**substr()**

`substr(start,end)` 方法需要两个参数 `start` 和 `end`，`end `代表返回的子字符串的**字符个数**；该方法返回这个字符串中从 `start` 位置的字符开始的 `end` 个字符的一个子字符串；
-  `end` 为 `undefined` 或不存在，则返回从 `start` 位置到字符串结尾的所有字符

-  `start` 是负数，则 `start = max(length + start,0)`

- `start` 是 `NaN`，则相当于 `start = 0`

-  `end` 是`负数`或 `NaN`，则 `end = 0`，因此会返回空字符串

- `start` 和 `end` 无法交换位置

::: warning
该方法不是ECMAScript标准，已经被弃用
:::

```js
var stringValue = 'hello world';
console.log(stringValue.substr());//'hello world'
console.log(stringValue.substr(2));//'llo world'
console.log(stringValue.substr(2,undefined));//'llo world'
console.log(stringValue.substr(2,NaN));//''
console.log(stringValue.substr(NaN,2));//'he'
console.log(stringValue.substr(20));//''
console.log(stringValue.substr(-2,3));//'ld'
console.log(stringValue.substr(-2,20));//'ld'
console.log(stringValue.substr(-20,2));//'he'
console.log(stringValue.substr(-20,-2));//''    
console.log(stringValue.substr(2,5));//llo w
```

### 正则匹配方法

`javascript` 中的一些正则操作如查找和测试等可以通过 `RegExp` 的方法实现，而切分和替换等另一些操作可以通过 `String` 类的方法实现

`String` 类共有 `match()`、`search()`、`replace()`、`split()` 4种正则匹配方法 

**match()**

`match()` 方法只接受一个为正则或字符串的参数，并以数组的形式返回匹配的内容。这个方法类似于正则表达式 `RegExp` 的 `exec()` 方法，只是调换了 `RegExp` 和 `String 对象的位置

若匹配失败，则 `match()`方法返回 `null`

- 若不设置全局标志，`match()`方法和`exec()`方法结果相同

```js
var string = 'cat,bat,sat,fat';
var pattern = /.at/;
var matches = string.match(pattern);
console.log(matches, matches.index, matches.input);//['cat'] 0 'cat,bat,sat,fat' 
var matches = string.match(pattern);
console.log(matches, matches.index, matches.input);//['cat'] 0 'cat,bat,sat,fat' 

var string = 'cat,bat,sat,fat';
var pattern = /.at/;
var exec = pattern.exec(string);
console.log(exec, exec.index, exec.input);//['cat'] 0 'cat,bat,sat,fat' 
var exec = pattern.exec(string);
console.log(exec, exec.index, exec.input);//['cat'] 0 'cat,bat,sat,fat' 
```

- 设置全局标志后，`exec()` 方法依然返回单次的匹配结果，而 `match()` 方法会返回一个字符串数组，其中包括各次成功匹配的文本，但没有 `index` 和 `input` 属性

```js
var string = 'cat,bat,sat,fat';
var pattern = /.at/g;
var matches = string.match(pattern);
console.log(matches, matches.index,matches.input);//["cat", "bat", "sat", "fat"] undefined undefined 
var matches = string.match(pattern);
console.log(matches, matches.index,matches.input);//["cat", "bat", "sat", "fat"] undefined undefined 

var string = 'cat,bat,sat,fat';
var pattern = /.at/g;
var exec = pattern.exec(string);
console.log(exec, exec.index, exec.input);//['cat'] 0 'cat,bat,sat,fat' 
var exec = pattern.exec(string);
console.log(exec, exec.index, exec.input);//['bat'] 4 'cat,bat,sat,fat' 
```

- 当不设置全局标志时，`match()`方法和 `exec()` 方法都包含捕获分组的信息；设置全局标志后，`match()` 方法不包含捕获分组的信息

```js
var string = 'cat,bat,sat,fat';
var pattern = /(.)at/g;

var matches = string.match(pattern);
console.log(matches);//['cat', 'bat', 'sat', 'fat'] 

var exec = pattern.exec(string);
console.log(exec);//['cat','c'] 

var string = 'cat,bat,sat,fat';
var pattern = /(.)at/;

var matches = string.match(pattern);
console.log(matches);//['cat','c'] 

var exec = pattern.exec(string);
console.log(exec);//['cat','c'] 
```

**search()**

`search()` 方法接受一个正则或字符串的参数，返回匹配的内容在字符串中首次出现的位置，类似于不能设置起始位置的 `indexOf`，找不到返回 `-1`

注意：`search()` 方法不执行全局匹配，忽略全局标志 `g`，也会忽略 `RegExp` 对象的 `lastIndex` 属性，总是从字符串的开始位置开始搜索

```js
var string = 'cat,bat,sat,fat';
var pattern = /.at/;
var pos = string.search(pattern);
console.log(pos);//0

var string = 'cat,bat,sat,fat';
var pattern = /.at/g;
var pos = string.search(pattern);
console.log(pos);//0

var string = 'cat,bat,sat,fat';
var pattern = 'at';
var pos = string.search(pattern);
console.log(pos);//1
```

**replace()**

`replace()` 方法用于替换一个或多个子字符串。它接收两个参数：第一个是正则表达式或字符串，表示待查找的内容；第二个是字符串或函数，表示替换内容。返回替换后的字符串

```js
var string = 'cat,bat,sat,fat';
var result = string.replace(/at/g,'ond');
console.log(result);//'cond,bond,sond,fond'
```

与 `match()` 和 `seartch()` 方法相比，`replace()` 方法更为强大，它可以在第二个参数中通过短属性名来使用某些正则表达式的静态属性

```
短属性名             说明
$&amp;          最近一次的匹配项
$`              匹配项之前的文本
$'              匹配项之后的文本
$1,$2...        表示第N个匹配捕获组
```

```js
var string = 'cat-bat-sat-fat';
console.log(string.replace(/(.)(at)/g,'$&amp;'));//'cat-bat-sat-fat'
console.log(string.replace(/(.)(at)/g,'$`'));//'-cat--cat-bat--cat-bat-sat-'
console.log(string.replace(/(.)(at)/g,"$'"));//'-bat-sat-fat--sat-fat--fat-'
console.log(string.replace(/(.)(at)/g,'$1'));//'c-b-s-f'
console.log(string.replace(/(.)(at)/g,'$2'));//'at-at-at-at'
```

`replace()` 方法的第二个参数可以是函数，这样文本的处理更加灵活

如果在只有一个匹配项的情况下，该方法会向这个函数传递3个参数：模式的匹配项、模式匹配项在字符串中的位置、原始字符串

```js
var string = 'cat,bat,sat,fat';
var index = 0;
var matchArray = [];
var posArray = [];
var text = '';
var result = string.replace(/at/g,function(match,pos,originalText){
    matchArray.push(match);
    posArray.push(pos);
    text = originalText;
    index++;
    if(index % 2){
        return 'wow';
    }else{
        return '0';
    }
});
console.log(matchArray);//["at", "at", "at", "at"]
console.log(posArray);//[1, 5, 9, 13]
console.log(text);//'cat,bat,sat,fat'
console.log(result);//'cwow,b0,swow,f0'
```

如果正则表达式定义多个捕获组，则该方法传递给函数的参数依次是模式的匹配项、第一个捕获组的匹配项、第二个捕获组的匹配项……第N个捕获组的匹配项，但最后两个参数仍然分别是模式的匹配项在字符串中的位置和原始字符串，这个函数返回一个字符串

```js
var string = 'cat,bat,sat,fat';
var index = 0;
var matchArray = [];
var m1Array = [];
var posArray = [];
var text = '';
var result = string.replace(/(.)at/g,function(match,m1,pos,originalText){
    matchArray.push(match);
    m1Array.push(m1);
    posArray.push(pos);
    text = originalText;
    return m1 + 'ta';
});
console.log(matchArray);//["cat", "bat", "sat", "fat"]
console.log(m1Array);//['c','b','s','f']
console.log(posArray);//[1, 5, 9, 13]
console.log(text);//'cat,bat,sat,fat'
console.log(result);//'cta,bta,sta,fta'
```

找出重复项最多的字符和个数

```JS
var str = 'aaaaabbbbbdddddaaaaaaaffffffffffffffffffgggggcccccce';
var pattern = /(\w)\1+/g;
var maxLength = 0;
var maxValue = '';
var result = str.replace(pattern,function(match,match1,pos,originalText){
    if(match.length > maxLength){
        maxLength = match.length;
        maxValue = match1;
    }
})
console.log(maxLength,maxValue);//18 "f"
```

**split()**

`split()` 方法基于指定的分隔符将一个字符串分割成多个字符串，并将结果放在一个数组中，分隔符可以是字符串，也可以是一个 `RegExp`

该方法可以接受第二个参数(可选)用于指定数组的大小，如果第二个参数为 `0-array.length` 范围内的值时按照指定参数输出，其他情况将所有结果都输出

```JS
var colorText = 'red,blue,green,yellow';
console.log(colorText.split(''));//["r", "e", "d", ",", "b", "l", "u", "e", ",", "g", "r", "e", "e", "n", ",", "y", "e", "l", "l", "o", "w"]
console.log(colorText.split(','));//["red", "blue", "green", "yellow"]
console.log(colorText.split(',',2));//["red", "blue"]
console.log(colorText.split(',',6));//["red", "blue", "green", "yellow"]
console.log(colorText.split('-'));//["red,blue,green,yellow"]
console.log(colorText.split(/\,/));//["red", "blue", "green", "yellow"]
console.log(colorText.split(/e/));//["r", "d,blu", ",gr", "", "n,y", "llow"]
console.log(colorText.split(/[^\,]+/));//将除去逗号以外的字符串变为分隔符["", ",", ",", ",", ""],IE8-会识别为[",",",",","]
```

### 字符串比较

`localeCompare()` 方法用于比较两个字符串，遵循下列规则

  【1】如果字符串在字母表中应该排在字符串参数之前，则返回一个负数(大多数情况下为-1)

  【2】如果字符串等于字符串参数，则返回0

  【3】如果字符串在字母表中应该排在字符串参数之后，则返回一个正数(大多数情况下为1)

```JS
var stringValue = 'yellow';
console.log(stringValue.localeCompare('brick'));//1  'y'&gt; 'b'
console.log(stringValue.localeCompare('yellow'));//0    'yellow' == 'yellow'
console.log(stringValue.localeCompare('zoo'));//-1        'yellow' &lt; 'zoo'
```