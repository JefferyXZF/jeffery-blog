---
title: 迭代器(Iterator)和生成器(Generator)
date: 2020-02-24 18:37:01
permalink: /pages/2323ssadse
author: 
  name: jeffery
categories: 
  - javascript
tags: 
  - javascript
---

# 迭代器(Iterator)和生成器(Generator)

## 迭代器

迭代器是一种特殊对象，它具有一些专门为迭代过程设计的专有接口，所有的迭代器对象都有一个 `next()` 方法，每次调用都返回一个结果对象。结果对象有两个属性：一个是 `value` ，表示下一个将要返回的值；另一个是 `done` ，它是一个布尔类型的值，当没有更多可返回数据时返回 `true`。迭代器还会保存一个内部指针，用来指向当前集合中值的位置，每调用一次 `next()` 方法，都会返回下一个可用的值

```js
function createIterator(items) {
    var i = 0;
    return {
        next: function() {
            var done = (i >= items.length);
            var value = !done ? items[i++] : undefined;
            return {
                done: done,
                value: value
            };
        }
    };
}
var iterator = createIterator([1, 2, 3]);
console.log(iterator.next()); // "{ value: 1, done: false }"
console.log(iterator.next()); // "{ value: 2, done: false }"
console.log(iterator.next()); // "{ value: 3, done: false }"
console.log(iterator.next()); // "{ value: undefined, done: true }"
// 之后的所有调用
console.log(iterator.next()); // "{ value: undefined, done: true }"
```

## 生成器

生成器是一种返回迭代器的函数，通过 `function` 关键字后的星号(*)来表示，函数中会用到新的关键字 `yield` 。星号可以紧挨着 `function` 关键字，也可以在中间添加一个空格

```js
// 生成器
function *createIterator() {
    yield 1;
    yield 2;
    yield 3;
}
// 生成器能像正规函数那样被调用，但会返回一个迭代器
let iterator = createIterator();
console.log(iterator.next().value); // 1
console.log(iterator.next().value); // 2
console.log(iterator.next().value); // 3
```

**使用限制**

- `yield` 关键字只可在生成器内部使用，在其他地方使用会导致程序抛出错误

```js
function *createIterator(items) {
    items.forEach(function(item) {
        // 语法错误
        yield item + 1;
    });
}
```

- 不能用箭头函数来创建生成器

## 可迭代对象

可迭代对象具有 `Symbol.iterator` 属性，是一种与迭代器密切相关的对象。`Symbol.iterator` 通过指定的函数可以返回一个作用于附属对象的迭代器

`for-of` 循环每执行一次都会调用可迭代对象的 `next()` 方法，并将迭代器返回的结果对象的 `value` 属性存储在一个变量中，循环将持续执行这一过程直到返回对象的 `done` 属性的值为 `true`。这里有个示例

```js
let values = [1, 2, 3];
for (let num of values) {
    //1
    //2
    //3
    console.log(num);
}
```

可以通过 `Symbol.iterator` 来访问对象默认的迭代器

```js
let values = [1, 2, 3];
let iterator = values[Symbol.iterator]();
console.log(iterator.next()); // "{ value: 1, done: false }"
console.log(iterator.next()); // "{ value: 2, done: false }"
console.log(iterator.next()); // "{ value: 3, done: false }"
console.log(iterator.next()); // "{ value: undefined, done: true }"
```

## 内建迭代器

在ES6中有3种类型的集合对象：数组、`Map` 集合与 `Set` 集合

　为了更好地访问对象中的内容，这3种对象都内建了以下三种迭代器

```
entries() 返回一个迭代器，其值为多个键值对
values() 返回一个迭代器，其值为集合的值
keys() 返回一个迭代器，其值为集合中的所有键名
```

### entries()迭代器

每次调用`next()`方法时，`entries()` 迭代器都会返回一个数组，数组中的两个元素分别表示集合中每个元素的键与值

```js
let colors = [ "red", "green", "blue" ];
let tracking = new Set([1234, 5678, 9012]);
let data = new Map();
data.set("title", "Understanding ES6");
data.set("format", "ebook");
for (let entry of colors.entries()) {
    console.log(entry);
}
for (let entry of tracking.entries()) {
    console.log(entry);
}
for (let entry of data.entries()) {
    console.log(entry);
}
```

输出结果

```js
[0, "red"]
[1, "green"]
[2, "blue"]
[1234, 1234]
[5678, 5678]
[9012, 9012]
["title", "Understanding ES6"]
["format", "ebook"]
```


### values()迭代器

调用 `values()` 迭代器时会返回集合中所存的所有值

```js
let colors = [ "red", "green", "blue" ];
let tracking = new Set([1234, 5678, 9012]);
let data = new Map();
data.set("title", "Understanding ES6");
data.set("format", "ebook");
for (let value of colors.values()) {
    console.log(value);
}
for (let value of tracking.values()) {
    console.log(value);
}
for (let value of data.values()) {
    console.log(value);
}
```

### keys()迭代器

keys()迭代器会返回集合中存在的每一个键。

```js
let colors = [ "red", "green", "blue" ];
let tracking = new Set([1234, 5678, 9012]);
let data = new Map();
data.set("title", "Understanding ES6");
data.set("format", "ebook");
for (let key of colors.keys()) {
    console.log(key);
}
for (let key of tracking.keys()) {
    console.log(key);
}
for (let key of data.keys()) {
    console.log(key);
}

```

输出结果

```js
0
1
2
1234
5678
9012
"title"
"format"
```

