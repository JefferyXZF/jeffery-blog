(window.webpackJsonp=window.webpackJsonp||[]).push([[268],{699:function(t,e,a){"use strict";a.r(e);var r=a(11),s=Object(r.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"自定义打印介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#自定义打印介绍"}},[t._v("#")]),t._v(" 自定义打印介绍")]),t._v(" "),a("h2",{attrs:{id:"背景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#背景"}},[t._v("#")]),t._v(" 背景")]),t._v(" "),a("p",[t._v("在很多企业的业务场景，企业希望将填写表单的数居打印出来，并且可以设置打印的样式，根据企业的需求可以设置不同的打印模板")]),t._v(" "),a("h2",{attrs:{id:"技术选型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#技术选型"}},[t._v("#")]),t._v(" 技术选型")]),t._v(" "),a("p",[t._v("产品设计是参考"),a("a",{attrs:{href:"https://hc.jiandaoyun.com/doc/9140",target:"_blank",rel:"noopener noreferrer"}},[t._v("简道云的自定义打印"),a("OutboundLink")],1),t._v("，左边是可以拖拽的字段面板，通过拖拽字段到 "),a("code",[t._v("excel")]),t._v(" 表格单元格上打印，所以需要在一个表格上渲染显示数据，根据网上的调研，有以下几种方案实现：")]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://www.grapecity.com.cn/developer/spreadjs",target:"_blank",rel:"noopener noreferrer"}},[t._v("SpreadJS"),a("OutboundLink")],1),t._v("：功能很丰富，但是收费很贵，按照开发人数收费，公司没有考虑")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/handsontable/handsontable",target:"_blank",rel:"noopener noreferrer"}},[t._v("handsontable"),a("OutboundLink")],1),t._v("：开源项目，高级功能需要付费，好在基本功能可以满足目前的功能，不过需要在这基础上进行二次开发")]),t._v(" "),a("li",[a("a",{attrs:{href:"https://github.com/mengshukeji/Luckysheet",target:"_blank",rel:"noopener noreferrer"}},[t._v("Luckysheet"),a("OutboundLink")],1),t._v("：国产完全开源的项目，功能也非常的丰富，迭代很快")])]),t._v(" "),a("p",[t._v("有点可惜，Luckysheet 项目开源的时间比较晚，当时开发时候还没有出来，所以没有用到公司项目上，最终使用的是 handsontable 项目。")]),t._v(" "),a("p",[t._v("数据渲染有了，那怎么转化为 pdf 文件下载并使用打印机打印呢？")]),t._v(" "),a("p",[t._v("通过github和网上搜索，比较成熟的方案是使用 "),a("a",{attrs:{href:"https://github.com/niklasvh/html2canvas",target:"_blank",rel:"noopener noreferrer"}},[t._v("html2canvas"),a("OutboundLink")],1),t._v(" 和 "),a("a",{attrs:{href:"https://github.com/MrRio/jsPDF",target:"_blank",rel:"noopener noreferrer"}},[t._v("jsPDF"),a("OutboundLink")],1),t._v(" 插件，通过 html2canvas 把页面转化为画布图像，然后利用 jsPDF 将图像转化为 pdf 文件")]),t._v(" "),a("h2",{attrs:{id:"功能介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#功能介绍"}},[t._v("#")]),t._v(" 功能介绍")]),t._v(" "),a("h3",{attrs:{id:"设计页面"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#设计页面"}},[t._v("#")]),t._v(" 设计页面")]),t._v(" "),a("ul",[a("li",[t._v("字段拖拽区域：可以将表单字段【内容】、表单字段【标题】、系统字段拖动到画布的指定位置")]),t._v(" "),a("li",[t._v("页面操作按钮：重置后端模板、操作（恢复默认模板、清空）、预览和保存自定义打印模板")]),t._v(" "),a("li",[t._v("工具栏：修改画布的样式，包括撤销恢复、设置字体大小、边框、对齐、合并单元格、设置图片显示比例、水印设置、子表单打印设置等")]),t._v(" "),a("li",[t._v("渲染区域：拖拽字段渲染的区域，或数据填充渲染的区域")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/FIF/pic-beg/raw/master/images/lowcode/image-20210809172809967.png",alt:"image-20210809172809967"}})]),t._v(" "),a("h3",{attrs:{id:"表单字段-系统字段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#表单字段-系统字段"}},[t._v("#")]),t._v(" 表单字段&系统字段")]),t._v(" "),a("ul",[a("li",[t._v("左侧表单字段，包括内容和标题两部分，因为字段是由这两部分组成的")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"center"}},[t._v("表单字段-内容")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("表单字段-标题")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("img",{attrs:{src:"https://gitee.com/FIF/pic-beg/raw/master/images/lowcode/image-20210809174728859.png",alt:"image-20210809174728859"}})]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("img",{attrs:{src:"https://gitee.com/FIF/pic-beg/raw/master/images/lowcode/image-20210809174757045.png",alt:"image-20210809174757045"}})])])])]),t._v(" "),a("ul",[a("li",[t._v("左侧系统字段，包括提交人、打印时间、评论等系统字段")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/FIF/pic-beg/raw/master/images/lowcode/image-20210809175025914.png",alt:"image-20210809175025914"}})]),t._v(" "),a("ul",[a("li",[t._v("列表中的字段内容表示字段值。见下图，把「日期字段」字段放至设计界面后，显示为「${日期字段}」。也就是说B2这个单元格代表的是，某条数据中日期字段的值，如“2020-06-06”")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/FIF/pic-beg/raw/master/images/lowcode/image-20210809175522806.png",alt:"image-20210809175522806"}})]),t._v(" "),a("ul",[a("li",[t._v("为了表示数据代表的意思，通常可以在字段值前面或者上面加上标题")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/FIF/pic-beg/raw/master/images/lowcode/image-20210809175703340.png",alt:"image-20210809175703340"}})]),t._v(" "),a("h3",{attrs:{id:"菜单工具栏"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#菜单工具栏"}},[t._v("#")]),t._v(" 菜单工具栏")]),t._v(" "),a("p",[t._v("（1）功能介绍")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/FIF/pic-beg/raw/master/images/lowcode/image-20210809181210939.png",alt:"image-20210809181210939"}})]),t._v(" "),a("ul",[a("li",[t._v("如果要取消边框线，在选中单元格后点击「边框线中的无边框」或者「边框线粗细中的无边框」。")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/FIF/pic-beg/raw/master/images/lowcode/image-20210809182425770.png",alt:"image-20210809182425770"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/FIF/pic-beg/raw/master/images/lowcode/image-20210809182449799.png",alt:"image-20210809182449799"}})]),t._v(" "),a("p",[t._v("（2）纸张设置")]),t._v(" "),a("ul",[a("li",[t._v("设置纸张大小，方向。注意参考线标注了打印时的边界，设计时不要超出，以免影响打印效果。")]),t._v(" "),a("li",[t._v("系统预设了几种常见的纸张大小，如A3,A4，也可以根据需要自定义纸张大小。")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/FIF/pic-beg/raw/master/images/lowcode/image-20210809182517956.png",alt:"image-20210809182517956"}})]),t._v(" "),a("p",[t._v("（3）参考线")]),t._v(" "),a("ul",[a("li",[t._v("参考线标注了打印范围，位于参考线之内的内容可以被打印出来。")])]),t._v(" "),a("blockquote",[a("p",[t._v("注意：参考线和实际打印边界，并不是完全重合的，会存在不一致的情况。参考线标注的范围 始终<= 实际打印范围")])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/FIF/pic-beg/raw/master/images/lowcode/image-20210809182912979.png",alt:"image-20210809182912979"}})]),t._v(" "),a("p",[t._v("（4）插入图片和背景图片")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("可上传背景图，注意先将图片调整至与纸张长宽比例一致再上传，这样可以等比例缩放填充纸张。打印背景开启后，打印时才会将背景图片一并打印出来")])]),t._v(" "),a("li",[a("p",[t._v("可在单元格中插入图片，打印出来。常见用法如插入公司logo等; 插入图片之后，可以通过改变单元格大小来调整图片大小，也可以设置图片比例。")])])]),t._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/FIF/pic-beg/raw/master/images/lowcode/image-20210809183136672.png",alt:"image-20210809183136672"}})]),t._v(" "),a("p",[t._v("（5）修改单元格打印的样式")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/FIF/pic-beg/raw/master/images/lowcode/image-20210809183529174.png",alt:"image-20210809183529174"}})]),t._v(" "),a("h3",{attrs:{id:"打印页面展示"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#打印页面展示"}},[t._v("#")]),t._v(" 打印页面展示")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://gitee.com/FIF/pic-beg/raw/master/images/lowcode/image-20210809182217917.png",alt:"image-20210809182217917"}})]),t._v(" "),a("h3",{attrs:{id:"打印功能的局限"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#打印功能的局限"}},[t._v("#")]),t._v(" 打印功能的局限")]),t._v(" "),a("ul",[a("li",[t._v("不支持批量打印")]),t._v(" "),a("li",[t._v("不支持数据选择范围打印，比如流程设置打印")]),t._v(" "),a("li",[t._v("合并单元格打印有可以出现样式偏差，IOS移动端样式不兼容的问题（插件限制）")]),t._v(" "),a("li",[t._v("图片字段多图片渲染的性能问题")])])])}),[],!1,null,null,null);e.default=s.exports}}]);